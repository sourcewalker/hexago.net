"use strict";function submitParticipation(e){InventorModule.processForm(e)}var validate={isEmpty:function(e){var t=new RegExp;return t.compile("^[s ]*$","gi"),t.test(e)},validateRegex:function(e,t){return!!new RegExp(e).test(t)},verifySpecialCharEmail:function(e){for(var t=0,a=e,r=0;r<a.length;r++)-1<"!#$ ".indexOf(a.charAt(r))&&t++;return 0==t},validateProcess:function(e){if("true"==e.attr("data-require")){var t=e.val(),a=e.attr("data-type"),r=e.attr("data-error-target"),i=0;if("text"==a&&(""==t||this.isEmpty(t)?(this.error_message("error",e,r,e.attr("data-required-message")),i++):this.error_message("good",e,r,"")),"regex"==a&&(""==t||this.isEmpty(t)?(this.error_message("error",e,r,e.attr("data-required-message")),i++):this.validateRegex(e.attr("data-regex-pattern"),t)?"email"==e.attr("type")?this.verifySpecialCharEmail(t)?1<(t.match(/@/g)||[]).length?(this.error_message("error",e,r,e.attr("data-pattern-message")),i++):this.error_message("good",e,r,""):(this.error_message("error",e,r,e.attr("data-pattern-message")),i++):this.error_message("good",e,r,""):(this.error_message("error",e,r,e.attr("data-pattern-message")),i++)),"ddl"==a&&("default"==t?(this.error_message("error",e,r,e.attr("data-required-message")),i++):this.error_message("good",e,r,"")),"checkbox"==a&&(e.is(":checked")?this.error_message("good",e,r,"",a):(this.error_message("error",e,r,e.attr("data-required-message"),a),i++)),"radio"==a){var s=e.closest("form").attr("id"),o=e.attr("name");0==$("#"+s).find("input[name="+o+"]:checked").length?(this.error_message("error",e,r,e.attr("data-required-message")),i++):this.error_message("good",e,r,"")}return 0==i}},validateField:function(e){$(e).find("input[type=text], input[type=email]").on("blur",function(){validate.validateProcess($(this))}),$(e).find("select").on("change",function(){validate.validateProcess($(this))}),$(e).find("input[type=checkbox]").on("change",function(){validate.validateProcess($(this))}),$(e).find("input[type=radio]").on("change",function(){validate.validateProcess($(this))})},validateForm:function(e){var t=0;return $(e).find("input[type=text], input[type=email], select, input[type=checkbox], input[type=radio]").each(function(){"true"==$(this).attr("data-require")&&(validate.validateProcess($(this))||t++)}),0==t},error_message:function(e,t,a,r,i){"error"==e?("checkbox"==i&&t.siblings(".checkmark").addClass("notvalid"),t.removeClass("valid").addClass("notvalid")):("checkbox"==i&&t.siblings(".checkmark").removeClass("notvalid"),t.removeClass("notvalid").addClass("valid"))}},InventorModule={processCaptcha:function(){try{""!=grecaptcha.getResponse()&&grecaptcha.reset(),grecaptcha.execute()}catch(e){console.log("Google Captcha: "+e)}},processForm:function(e){$("#js-submit-vote").attr("disabled",!0),$(".js-view-loader").show();var t="";t=-1<window.location.host.indexOf("azurewebsites")?"https://services-cadburyinventor-staging.azurewebsites.net/vote/mopup":-1<window.location.host.indexOf("local")?"http://local.inventor-voting.service.co.uk/vote/mopup":"https://services.cadburyinventor.com/vote/mopup";var a={Email:$("#email").val(),Culture:"en-GB",NewsletterOptin:$("#newsletter").is(":checked"),Captcha:e},r={cache:!1,url:t,method:"POST",headers:{Authorization:"Basic "+btoa("Proximity:k2P6WnRQEgPCmt7q8mtKfLW6bW4fcd")},dataType:"json",data:a};$.ajax(r).always(function(e,t,a){200==a.status?1==e.Success&&(ScrollTo({target:".holding",callback:function(){$(".js-view-vote, .main-content h3, .main-content .s-content, .main-content .s-content-form").hide(),$(".js-view-thankyou").show(),$(".js-view-loader").hide()}}),appGoogleTracking.dataLayerPush({dataEvent:"button-click",dataCategory:"Click Action",dataAction:"Keep Updated",dataLabel:document.title})):($("#js-submit-vote").attr("disabled",!1),$(".js-view-loader").hide())})},eventHandlers:function(){var e=this;$("#frm-vote").on("submit",function(e){return e.preventDefault(),!1}),validate.validateField("#frm-vote"),$("#js-submit-vote").on("click",function(){validate.validateForm("#frm-vote")&&e.processCaptcha()})},init:function(){this.eventHandlers()}};$(document).ready(function(){InventorModule.init()});
//# sourceMappingURL=holding.min.js.map